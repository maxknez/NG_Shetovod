
# Discord Task Bot

Этот Discord бот предназначен для управления задачами (тасками) на вашем сервере. Он позволяет пользователям создавать, назначать и закрывать задачи, а также отслеживать их статус и личный рейтинг за выполнение задач.

## Возможности

*   **Создание задач:** Пользователи могут добавлять новые задачи с уникальным ключом и описанием.
*   **Назначение задач:** Пользователи могут взять на себя выполнение задачи, изменив ее статус.
*   **Закрытие задач:** После выполнения задачи пользователь может закрыть ее, получая за это очки рейтинга.
*   **Отслеживание статусов:** Задачи имеют статусы "Надо сделать", "Назначено", "Выполнено".
*   **Актуальный список задач:** В специальном канале бот автоматически поддерживает сообщение со списком всех активных (невыполненных) задач.
*   **Список выполненных задач:** Отдельная команда для просмотра всех завершенных задач.
*   **Система рейтинга:** Пользователи получают очки за выполнение задач, можно посмотреть свой рейтинг и топ-игроков.
*   **Приветствие при запуске:** Бот отправляет случайное приветствие в указанный канал при каждом запуске.

## Установка и запуск

Для запуска бота следуйте этим шагам:

### 1. Клонирование репозитория (или создание файлов)

Создайте следующую структуру файлов и папок в корневой директории вашего проекта:

```
your_bot_project/
├── bot.py
├── cogs/
│   ├── rating.py
│   ├── tasks.py
│   └── utils.py
├── database.py
├── settings.py
├── .env
└── requirements.txt
```

### 2. Установка зависимостей

Перейдите в корневую директорию проекта в терминале и установите необходимые библиотеки:

```bash
pip install -r requirements.txt
```

Содержимое `requirements.txt`:
```
discord.py
python-dotenv
```

### 3. Настройка `.env` файла

Создайте файл с именем `.env` в корневой директории вашего проекта. В этот файл нужно добавить токен вашего Discord бота и ID канала, куда бот будет отправлять служебные сообщения и список задач.

```
DISCORD_BOT_TOKEN=ВАШ_ТОКЕН_БОТА
CHANNEL_ID=ID_КАНАЛА_ДЛЯ_ЗАДАЧ_И_ПРИВЕТСТВИЙ
```

*   **Как получить токен бота:**
    1.  Перейдите на [Discord Developer Portal](https://discord.com/developers/applications).
    2.  Создайте новое приложение или выберите существующее.
    3.  Перейдите в раздел "Bot" и нажмите "Add Bot".
    4.  Скопируйте токен. **Никогда не делитесь этим токеном!**
*   **Как получить ID канала:**
    1.  В Discord, перейдите в "Настройки пользователя" -> "Расширенные" и включите "Режим разработчика".
    2.  Правый клик по нужному каналу на сервере и выберите "Копировать ID".

### 4. Приглашение бота на сервер

1.  На странице Discord Developer Portal вашего приложения, перейдите в раздел "OAuth2" -> "URL Generator".
2.  Выберите следующиеScopes: `bot`, `applications.commands`.
3.  Для Bot Permissions (Права бота) выберите:
    *   `Send Messages` (Отправлять сообщения)
    *   `Manage Messages` (Управлять сообщениями) - необходимо для закрепления сообщений (если есть команда `/pin` в `utils.py`) и редактирования сообщений.
    *   `Read Message History` (Читать историю сообщений) - необходимо для поиска сообщения со списком задач.
    *   `View Channels` (Читать текстовые/голосовые каналы)
    *   `Manage Channels` (Управлять каналами) - если бот будет создавать или изменять каналы (необязательно для текущего функционала).
4.  Скопируйте сгенерированную ссылку и используйте ее для приглашения бота на ваш сервер.

### 5. Запуск бота

Перейдите в корневую директорию проекта в терминале и запустите бота:

```bash
python bot.py
```

При первом запуске будет создан файл базы данных `tasks.db` и инициализированы необходимые таблицы.

---

## Использование команд

Все команды бота являются слеш-командами (`/`). Просто введите `/` в Discord, чтобы увидеть доступные команды.

*   **`/ping`**
    *   Проверяет задержку (latency) бота.
    *   Пример: `/ping`
*   **`/добавить ключ: [ключ_задачи] текст: [текст_задачи]`**
    *   Создает новую задачу. Ключ должен быть уникальным.
    *   Пример: `/добавить ключ: купить_молоко текст: Сходить в магазин и купить молоко`
*   **`/удалить ключ: [ключ_задачи]`**
    *   Удаляет задачу по указанному ключу. Удалить задачу может только ее автор или администратор.
    *   Пример: `/удалить ключ: купить_молоко`
*   **`/взять ключ: [ключ_задачи]`**
    *   Присваивает задачу себе, меняя ее статус на "Назначено".
    *   Пример: `/взять ключ: купить_молоко`
*   **`/закрыть ключ: [ключ_задачи]`**
    *   Закрывает задачу, если она была назначена вам. Вы получаете 1 очко рейтинга.
    *   Пример: `/закрыть ключ: купить_молоко`
*   **`/выполненные`**
    *   Показывает список всех выполненных задач.
    *   Пример: `/выполненные`
*   **`/мой_рейтинг`**
    *   Показывает ваш текущий рейтинг.
    *   Пример: `/мой_рейтинг`
*   **`/топ_рейтинг`**
    *   Показывает список 10 пользователей с наивысшим рейтингом.
    *   Пример: `/топ_рейтинг`

## Структура проекта

```
.
├── bot.py              # Основной файл бота, инициализация и запуск.
├── cogs/
│   ├── rating.py       # Команды, связанные с системой рейтинга.
│   ├── tasks.py        # Команды для управления задачами (добавление, удаление, взятие, закрытие, список выполненных).
│   └── utils.py        # Вспомогательные функции (ping, приветствие при запуске, обновление списка активных задач).
├── database.py         # Модуль для работы с SQLite базой данных (CRUD операции с задачами и рейтингом).
├── settings.py         # Файл для загрузки настроек из .env.
├── .env                # Хранит чувствительные данные (токен бота, ID канала).
└── requirements.txt    # Список необходимых Python-библиотек.
```

